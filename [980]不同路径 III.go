//åœ¨äºŒç»´ç½‘æ ¼ grid ä¸Šï¼Œæœ‰ 4 ç§ç±»å‹çš„æ–¹æ ¼ï¼š
//
//
// 1 è¡¨ç¤ºèµ·å§‹æ–¹æ ¼ã€‚ä¸”åªæœ‰ä¸€ä¸ªèµ·å§‹æ–¹æ ¼ã€‚
// 2 è¡¨ç¤ºç»“æŸæ–¹æ ¼ï¼Œä¸”åªæœ‰ä¸€ä¸ªç»“æŸæ–¹æ ¼ã€‚
// 0 è¡¨ç¤ºæˆ‘ä»¬å¯ä»¥èµ°è¿‡çš„ç©ºæ–¹æ ¼ã€‚
// -1 è¡¨ç¤ºæˆ‘ä»¬æ— æ³•è·¨è¶Šçš„éšœç¢ã€‚
//
//
// è¿”å›åœ¨å››ä¸ªæ–¹å‘ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³ï¼‰ä¸Šè¡Œèµ°æ—¶ï¼Œä»èµ·å§‹æ–¹æ ¼åˆ°ç»“æŸæ–¹æ ¼çš„ä¸åŒè·¯å¾„çš„æ•°ç›®ã€‚
//
// æ¯ä¸€ä¸ªæ— éšœç¢æ–¹æ ¼éƒ½è¦é€šè¿‡ä¸€æ¬¡ï¼Œä½†æ˜¯ä¸€æ¡è·¯å¾„ä¸­ä¸èƒ½é‡å¤é€šè¿‡åŒä¸€ä¸ªæ–¹æ ¼ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
// è¾“å…¥ï¼š[[1,0,0,0],[0,0,0,0],[0,0,2,-1]]
//è¾“å‡ºï¼š2
//è§£é‡Šï¼šæˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸¤æ¡è·¯å¾„ï¼š
//1. (0,0),(0,1),(0,2),(0,3),(1,3),(1,2),(1,1),(1,0),(2,0),(2,1),(2,2)
//2. (0,0),(1,0),(2,0),(2,1),(1,1),(0,1),(0,2),(0,3),(1,3),(1,2),(2,2)
//
// ç¤ºä¾‹ 2ï¼š
//
// è¾“å…¥ï¼š[[1,0,0,0],[0,0,0,0],[0,0,0,2]]
//è¾“å‡ºï¼š4
//è§£é‡Šï¼šæˆ‘ä»¬æœ‰ä»¥ä¸‹å››æ¡è·¯å¾„ï¼š
//1. (0,0),(0,1),(0,2),(0,3),(1,3),(1,2),(1,1),(1,0),(2,0),(2,1),(2,2),(2,3)
//2. (0,0),(0,1),(1,1),(1,0),(2,0),(2,1),(2,2),(1,2),(0,2),(0,3),(1,3),(2,3)
//3. (0,0),(1,0),(2,0),(2,1),(2,2),(1,2),(1,1),(0,1),(0,2),(0,3),(1,3),(2,3)
//4. (0,0),(1,0),(2,0),(2,1),(1,1),(0,1),(0,2),(0,3),(1,3),(1,2),(2,2),(2,3)
//
// ç¤ºä¾‹ 3ï¼š
//
// è¾“å…¥ï¼š[[0,1],[2,0]]
//è¾“å‡ºï¼š0
//è§£é‡Šï¼š
//æ²¡æœ‰ä¸€æ¡è·¯èƒ½å®Œå…¨ç©¿è¿‡æ¯ä¸€ä¸ªç©ºçš„æ–¹æ ¼ä¸€æ¬¡ã€‚
//è¯·æ³¨æ„ï¼Œèµ·å§‹å’Œç»“æŸæ–¹æ ¼å¯ä»¥ä½äºç½‘æ ¼ä¸­çš„ä»»æ„ä½ç½®ã€‚
//
//
//
//
// æç¤ºï¼š
//
//
// 1 <= grid.length * grid[0].length <= 20
//
//
// Related Topics ä½è¿ç®— æ•°ç»„ å›æº¯ çŸ©é˜µ ğŸ‘ 223 ğŸ‘ 0

package main

//leetcode submit region begin(Prohibit modification and deletion)
func uniquePathsIII(grid [][]int) int {
	total := 1
	m, n := len(grid), len(grid[0])
	startm, startn, endm, endn := 0, 0, 0, 0
	for i := 0; i < m; i++ {
		for j := 0; j < n; j++ {
			switch grid[i][j] {
			case 1:
				startm, startn = i,j
			case 2:
				endm, endn = i,j
			case 0:
				total++
			}
		}
	}
	return dfs(grid, startm, startn, endm, endn, total)
}

// DFS+å›æº¯
func dfs(grid [][]int, startm, startn, endm, endn, total int) (res int) {
	//	å…ˆåˆ¤æ–­æ˜¯å¦è¶…è¿‡
	m, n := len(grid), len(grid[0])
	if startm < 0 || startm >= m || startn < 0 || startn >= n {
		return
	}

	// åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯éšœç¢
	if grid[startm][startn] == -1 {
		return
	}

	// åˆ¤æ–­å½“å‰éšœç¢æ˜¯å¦æ˜¯ç»ˆç‚¹
	if grid[startm][startn] == 2 {
		// å¦‚æœæ˜¯ç»ˆç‚¹ï¼Œåˆ¤æ–­æ˜¯å¦ä¸€ä¸ªç©ºçš„æ ¼å­éƒ½æ²¡æœ‰
		if total == 0 {
			return 1
		}
		// å¦‚æœè¿˜æœ‰ç©ºæ ¼å­ï¼Œå°±å›æº¯
		return 0
	}

	//éƒ½ä¸æ˜¯ï¼Œåˆ™å°†å››ä¸ªæ–¹å‘ç»§ç»­DFS
	grid[startm][startn] = -1
	res += dfs(grid, startm-1, startn, endm, endn, total-1)
	res += dfs(grid, startm, startn+1, endm, endn, total-1)
	res += dfs(grid, startm+1, startn, endm, endn, total-1)
	res += dfs(grid, startm, startn-1, endm, endn, total-1)

	// å›æº¯ï¼Œå°†çŠ¶æ€æ”¹å›æ¥
	grid[startm][startn] = 0
	return res
}

//leetcode submit region end(Prohibit modification and deletion)
